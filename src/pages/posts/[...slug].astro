---
import Layout from '../../layouts/Layout.astro';
import Article from '../../components/Article.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

// Fetch all posts for category and tag navigation
const allPosts = await getCollection('posts');

// Get unique categories
const categories = [...new Set(allPosts.map(p => p.data.category || 'Uncategorized'))];

// Get top 4 categories by post count for footer
const categoryCounts = categories.map(category => ({
  name: category,
  count: allPosts.filter(p => (p.data.category || 'Uncategorized') === category).length,
})).sort((a, b) => b.count - a.count).slice(0, 4);

const absoluteImageUrl = post.data.image
  ? post.data.image.startsWith('http') 
    ? post.data.image 
    : `https://www.jonathanmwaniki.co.ke${post.data.image.startsWith('/') ? '' : '/'}${post.data.image}`
  : 'https://www.jonathanmwaniki.co.ke/default-og-image.jpg';

// Enhanced SEO keywords targeting Kenyan market and major competitors
const competitiveKeywords = [
  'Kenya news today',
  'breaking news Kenya',
  'latest Kenyan news',
  'Nairobi news',
  'Kenya politics news',
  'Kenyan entertainment news',
  'celebrity gossip Kenya',
  'trending Kenya stories',
  'Kenya business news',
  'Kenya sports news',
  'Nairobi gossip',
  'Kenya lifestyle news',
  'Kenyan celebrities',
  'Kenya current affairs',
  'East Africa news',
  'Nairobi entertainment',
  'Kenya viral news',
  'trending Nairobi',
  'Kenya social media trends',
  'Kenyan influencers',
  'Kenya showbiz',
  'Nairobi lifestyle',
  'Kenya hot topics',
  post.data.category?.toLowerCase(),
  ...(post.data.tags || [])
].filter(Boolean).join(', ');

// Dynamic title optimization based on category
const getOptimizedTitle = (title, category) => {
  const categoryKeywords = {
    'politics': 'Kenya Politics News',
    'entertainment': 'Kenya Entertainment & Celebrity Gossip',
    'business': 'Kenya Business News Today',
    'sports': 'Kenya Sports News & Updates',
    'lifestyle': 'Kenya Lifestyle & Trending Stories',
    'technology': 'Kenya Tech News & Innovation',
    'health': 'Kenya Health News & Updates'
  };
  
  const categoryTag = categoryKeywords[category?.toLowerCase()] || 'Breaking Kenya News';
  return `${title || 'Untitled'} | ${categoryTag} | Jonathan Mwaniki`;
};

// Enhanced description for SEO
const getOptimizedDescription = (description, category, title) => {
  const baseDesc = description || title || 'Untitled';
  const categoryContext = {
    'politics': 'Latest political developments and government updates from Kenya.',
    'entertainment': 'Celebrity news, entertainment gossip, and showbiz updates from Kenya.',
    'business': 'Business news, economic updates, and market analysis from Kenya.',
    'sports': 'Sports news, match updates, and athlete stories from Kenya.',
    'lifestyle': 'Lifestyle trends, social stories, and cultural updates from Kenya.',
    'technology': 'Technology news, innovation, and digital trends in Kenya.',
    'health': 'Health news, medical updates, and wellness information for Kenyans.'
  };
  
  const context = categoryContext[category?.toLowerCase()] || 'Breaking news and trending stories from Kenya.';
  return `${baseDesc} ${context} Stay updated with Jonathan Mwaniki - your trusted source for Kenyan news.`;
};

const optimizedTitle = getOptimizedTitle(post.data.title, post.data.category);
const optimizedDescription = getOptimizedDescription(post.data.description, post.data.category, post.data.title);
---

<Layout 
  title={optimizedTitle}
  description={optimizedDescription}
  image={absoluteImageUrl}
  canonical={`https://www.jonathanmwaniki.co.ke/posts/${post.slug}`}
  meta={[
    { name: 'og:title', content: `${post.data.title || 'Untitled'} | Jonathan Mwaniki` },
    { name: 'og:description', content: optimizedDescription },
    { name: 'og:type', content: 'article' },
    { name: 'og:url', content: `https://www.jonathanmwaniki.co.ke/posts/${post.slug}` },
    { name: 'og:image', content: absoluteImageUrl },
    { name: 'og:image:alt', content: post.data.imageAlt || `${post.data.title || 'Untitled'} - Jonathan Mwaniki` },
    { name: 'og:site_name', content: "Jonathan Mwaniki - Kenya News" },
    { name: 'og:locale', content: 'en_KE' },
    { name: 'twitter:card', content: 'summary_large_image' },
    { name: 'twitter:title', content: `${post.data.title || 'Untitled'} | Jonathan Mwaniki` },
    { name: 'twitter:description', content: optimizedDescription },
    { name: 'twitter:image', content: absoluteImageUrl },
    { name: 'twitter:image:alt', content: post.data.imageAlt || `${post.data.title || 'Untitled'} - Jonathan Mwaniki` },
    { name: 'twitter:site', content: '@maestropuns' },
    { name: 'twitter:creator', content: '@maestropuns' },
    { name: 'keywords', content: competitiveKeywords },
    { name: 'robots', content: 'index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1' },
    { name: 'author', content: post.data.author || 'Jonathan Mwaniki' },
    { name: 'publisher', content: 'Jonathan Mwaniki News' },
    { name: 'article:author', content: post.data.author || 'Jonathan Mwaniki' },
    { name: 'article:published_time', content: post.data.date },
    { name: 'article:modified_time', content: post.data.updatedDate || post.data.date },
    { name: 'article:section', content: post.data.category || 'Uncategorized' },
    { name: 'article:tag', content: (post.data.tags || []).join(', ') },
    { name: 'news_keywords', content: `Kenya, Nairobi, ${post.data.category || 'Uncategorized'}, breaking news, trending` },
    { name: 'geo.region', content: 'KE' },
    { name: 'geo.country', content: 'Kenya' },
    { name: 'geo.placename', content: 'Nairobi' },
    { name: 'ICBM', content: '-1.286389, 36.817223' },
    { name: 'theme-color', content: '#dc2626' },
    { name: 'msapplication-TileColor', content: '#dc2626' },
  ]}
>
  <!-- Structured Data, FAQ, and Breadcrumb Schemas (unchanged) -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "headline": "${post.data.title || 'Untitled'}",
      "alternativeHeadline": "${post.data.title || 'Untitled'} - Kenya News Today",
      "image": {
        "@type": "ImageObject",
        "url": "${absoluteImageUrl}",
        "width": 1200,
        "height": 630
      },
      "datePublished": "${post.data.date}",
      "dateModified": "${post.data.updatedDate || post.data.date}",
      "author": {
        "@type": "Person",
        "name": "${post.data.author || 'Jonathan Mwaniki'}",
        "url": "https://www.jonathanmwaniki.co.ke/about",
        "sameAs": [
          "https://twitter.com/maestropuns",
          "https://www.linkedin.com/in/jonathanmwaniki"
        ]
      },
      "publisher": {
        "@type": "Organization",
        "name": "Jonathan Mwaniki News",
        "url": "https://www.jonathanmwaniki.co.ke",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.jonathanmwaniki.co.ke/logo.png",
          "width": 300,
          "height": 100
        },
        "sameAs": [
          "https://twitter.com/maestropuns",
          "https://www.facebook.com/jonathanmwaniki"
        ]
      },
      "description": "${optimizedDescription}",
      "articleBody": "${post.data.description || 'No description available'}",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.jonathanmwaniki.co.ke/posts/${post.slug}"
      },
      "keywords": "${competitiveKeywords}",
      "articleSection": "${post.data.category || 'Uncategorized'}",
      "wordCount": "800",
      "isAccessibleForFree": true,
      "hasPart": {
        "@type": "WebPageElement",
        "isAccessibleForFree": true,
        "cssSelector": ".article-wrapper"
      },
      "speakable": {
        "@type": "SpeakableSpecification",
        "cssSelector": [".post-title", ".post-description"]
      },
      "about": {
        "@type": "Thing",
        "name": "Kenya News"
      },
      "mentions": [
        {
          "@type": "Place",
          "name": "Kenya"
        },
        {
          "@type": "Place", 
          "name": "Nairobi"
        }
      ]
    }
  </script>

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is the latest news from Kenya today?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Stay updated with breaking news from Kenya including politics, entertainment, business, and sports. Jonathan Mwaniki brings you the latest trending stories from Nairobi and across Kenya."
          }
        },
        {
          "@type": "Question", 
          "name": "Where can I find reliable Kenya news and gossip?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Jonathan Mwaniki provides trusted Kenya news, celebrity gossip, political updates, and trending stories. Get the latest from Nairobi's entertainment scene and Kenya's political landscape."
          }
        }
      ]
    }
  </script>

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Kenya News Home",
          "item": "https://www.jonathanmwaniki.co.ke"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "${post.data.category || 'Uncategorized'} News Kenya",
          "item": "https://www.jonathanmwaniki.co.ke/category/${post.data.category ? post.data.category.toLowerCase().replace(/\s+/g, '-') : 'uncategorized'}"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "${post.data.title || 'Untitled'}",
          "item": "https://www.jonathanmwaniki.co.ke/posts/${post.slug}"
        }
      ]
    }
  </script>

  <!-- Top Ad -->
  <div class="ad-container">
    <script type="text/javascript">
      atOptions = {
        'key': '1610960d9ced232cc76d8f5510ee4608',
        'format': 'iframe',
        'height': 60,
        'width': 468,
        'params': {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/1610960d9ced232cc76d8f5510ee4608/invoke.js"></script>
  </div>

  <div class="reading-progress">
    <div class="reading-progress-bar" id="progress-bar"></div>
  </div>

  <div class="post-container">
    <nav aria-label="Breadcrumb">
      <ol class="breadcrumb">
        <li><a href="/" title="Kenya News Home">Home</a></li>
        <li><a href={`/category/${post.data.category ? post.data.category.toLowerCase().replace(/\s+/g, '-') : 'uncategorized'}`} title={`${post.data.category || 'Uncategorized'} News Kenya`}>{post.data.category || 'Uncategorized'}</a></li>
        <li aria-current="page">{post.data.title || 'Untitled'}</li>
      </ol>
    </nav>

    <!-- Category Navigation Bar with Horizontal Slider on Mobile -->
    <nav class="category-nav" aria-label="Category Navigation">
      <h3 style="margin: 0.5rem 0; color: #1a202c;">Explore Kenya News Categories</h3>
      <div class="category-slider">
        <ul style="list-style: none; padding: 0; display: flex; gap: 0.5rem;">
          {categories.map(category => (
            <li>
              <a 
                href={`/category/${category.toLowerCase().replace(/\s+/g, '-')}`} 
                title={`${category} News Kenya`} 
                style="background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600; text-transform: uppercase; text-decoration: none; white-space: nowrap;"
              >
                {category}
              </a>
            </li>
          ))}
        </ul>
      </div>
    </nav>

    <a href="/" class="back-link" title="Back to Kenya Breaking News">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
      Back to Kenya News
    </a>
    
    {post.data.draft && (
      <div class="draft-notice">
        ‚ö†Ô∏è This is a draft article and may contain incomplete content
      </div>
    )}
    
    <article itemscope itemtype="https://schema.org/NewsArticle">
      <header class="post-header">
        <div class="post-meta">
          <span class="post-category">
            <a href={`/category/${post.data.category ? post.data.category.toLowerCase().replace(/\s+/g, '-') : 'uncategorized'}`} title={`${post.data.category || 'Uncategorized'} News Kenya`}>
              {post.data.category || 'Uncategorized'}
            </a>
          </span>
          <time class="post-date" datetime={post.data.date} itemprop="datePublished">
            {new Date(post.data.date).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </time>
          <span class="reading-time">üìñ 5 min read</span>
        </div>
        
        <h1 class="post-title" itemprop="headline">{post.data.title || 'Untitled'}</h1>
        
        {post.data.description && (
          <p class="post-description" itemprop="description">{post.data.description}</p>
        )}

        <div class="author-info" itemprop="author" itemscope itemtype="https://schema.org/Person">
          <span>By <strong itemprop="name">{post.data.author || 'Jonathan Mwaniki'}</strong></span>
          <span class="author-title">Kenya News Editor</span>
        </div>
      </header>
      
      {post.data.image && (
        <div class="post-image-container">
          <img 
            src={post.data.image}
            alt={post.data.imageAlt || `${post.data.title || 'Untitled'} - Jonathan Mwaniki`}
            class="post-featured-image"
            loading="lazy"
            itemprop="image"
            width="800"
            height="450"
          />
          <div class="post-image-overlay"></div>
        </div>
      )}
      
      <!-- Middle Ad -->
      <div class="ad-container">
        <script type="text/javascript">
          atOptions = {
            'key': '1610960d9ced232cc76d8f5510ee4608',
            'format': 'iframe',
            'height': 60,
            'width': 468,
            'params': {}
          };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/1610960d9ced232cc76d8f5510ee4608/invoke.js"></script>
      </div>
      
      <div class="article-wrapper" itemprop="articleBody">
        <Article>
          <Content />
        </Article>
      </div>

      <!-- In-Content Related Articles -->
      <section class="mid-content-links">
        <h3 style="margin: 1.5rem 0 1rem; color: #1a202c;">Explore More {post.data.category || 'Uncategorized'} Stories</h3>
        <ul style="list-style: none; padding: 0; display: grid; gap: 1rem;">
          {
            (await getCollection('posts'))
              .filter(p => p.data.category === post.data.category && p.slug !== post.slug)
              .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
              .slice(0, 2)
              .map(relatedPost => (
                <li>
                  <a 
                    href={`/posts/${relatedPost.slug}`} 
                    title={`${relatedPost.data.title} - ${post.data.category || 'Uncategorized'} News Kenya`} 
                    style="text-decoration: none; color: #2d3748; font-weight: 600; display: block;"
                    class="related-link"
                  >
                    {relatedPost.data.title}
                  </a>
                </li>
              ))
          }
        </ul>
      </section>

      <!-- Keywords section for SEO with only post-specific tags -->
      <div class="article-tags" style="margin: 2rem 0; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
        <h4 style="margin: 0 0 0.5rem 0; color: #333;">Related Topics:</h4>
        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
          {(post.data.tags || []).map(tag => (
            <a 
              href={`/tags/${tag.toLowerCase().replace(/\s+/g, '-')}`} 
              style="background: #dc2626; color: white; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.8rem; text-decoration: none;" 
              title={`${tag} News Kenya`}
            >
              {tag}
            </a>
          ))}
        </div>
      </div>

      <!-- Dynamic Related Articles Section -->
      <section class="related-articles">
        <h2>More {post.data.category || 'Uncategorized'} News & Updates</h2>
        <ul>
          {
            (await getCollection('posts'))
              .filter(p => p.data.category === post.data.category && p.slug !== post.slug)
              .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
              .slice(0, 3)
              .map(relatedPost => (
                <li>
                  <a href={`/posts/${relatedPost.slug}`} title={`${relatedPost.data.title} - ${post.data.category || 'Uncategorized'} News Kenya`}>
                    {relatedPost.data.title}
                  </a>
                </li>
              ))
          }
        </ul>
        <p><a href={`/category/${post.data.category ? post.data.category.toLowerCase().replace(/\s+/g, '-') : 'uncategorized'}`} title={`More ${post.data.category || 'Uncategorized'} News Kenya`}>See more {post.data.category || 'Uncategorized'} stories</a></p>
      </section>
      
      <!-- Newsletter Signup -->
      <div class="newsletter-signup" style="background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; padding: 2rem; border-radius: 12px; margin: 2rem 0; text-align: center;">
        <h3 style="margin: 0 0 1rem 0;">Stay Updated with Kenya News</h3>
        <p style="margin: 0 0 1.5rem 0;">Get breaking news from Kenya delivered to your inbox. Politics, entertainment, business & trending stories.</p>
        <div style="display: flex; gap: 0.5rem; max-width: 400px; margin: 0 auto;">
          <input type="email" placeholder="Enter your email" style="flex: 1; padding: 0.75rem; border: none; border-radius: 6px;">
          <button style="background: white; color: #dc2626; border: none; padding: 0.75rem 1.5rem; border-radius: 6px; font-weight: 600; cursor: pointer;">Subscribe</button>
        </div>
      </div>
      
      <!-- Bottom Ad -->
      <div class="ad-container">
        <script type="text/javascript">
          atOptions = {
            'key': '1610960d9ced232cc76d8f5510ee4608',
            'format': 'iframe',
            'height': 60,
            'width': 468,
            'params': {}
          };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/1610960d9ced232cc76d8f5510ee4608/invoke.js"></script>
      </div>
      
      <footer class="post-footer">
        <div class="post-footer-content">
          <h3>Share This Breaking Kenya News</h3>
          <p>Enjoyed this article? Share the latest Kenya news with your friends!</p>
          <div class="social-share">
            <a 
              href={`https://x.com/intent/tweet?text=${encodeURIComponent(`${post.data.title || 'Untitled'} - Jonathan Mwaniki`)}&url=${encodeURIComponent(`https://www.jonathanmwaniki.co.ke/posts/${post.slug}`)}&hashtags=KenyaNews,NairobiUpdates,BreakingNews`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button x"
              aria-label="Share Kenya news on X"
              title="Share this Kenya news story on X"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              X
            </a>
            
            <a 
              href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(`https://www.jonathanmwaniki.co.ke/posts/${post.slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button linkedin"
              aria-label="Share Kenya news on LinkedIn"
              title="Share this Kenya news story on LinkedIn"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452z"/>
              </svg>
              LinkedIn
            </a>
            
            <a 
              href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(`https://www.jonathanmwaniki.co.ke/posts/${post.slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button facebook"
              aria-label="Share Kenya news on Facebook"
              title="Share this Kenya news story on Facebook"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M22.675 0H1.325C.593 0 0 .593 0 1.325v21.351C0 23.407.593 24 1.325 24H12.82v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116c.73 0 1.323-.593 1.323-1.325V1.325C24 .593 23.407 0 22.675 0z"/>
              </svg>
              Facebook
            </a>

            <a 
              href={`whatsapp://send?text=${encodeURIComponent(`${post.data.title || 'Untitled'} - Jonathan Mwaniki: https://www.jonathanmwaniki.co.ke/posts/${post.slug}`)}`}
              target="_blank"
              rel="noopener noreferrer"
              class="share-button whatsapp"
              aria-label="Share Kenya news on WhatsApp"
              title="Share this Kenya news story on WhatsApp"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.488"/>
              </svg>
              WhatsApp
            </a>
          </div>
          
          <!-- Author bio -->
          <div class="author-bio" style="margin-top: 2rem; padding: 1.5rem; background: #f8f9fa; border-radius: 8px;">
            <h4 style="margin: 0 0 1rem 0;">About the Author</h4>
            <p style="margin: 0; line-height: 1.6;"><strong>{post.data.author || 'Jonathan Mwaniki'}</strong> is a leading Kenya news journalist with over 5 years of experience covering politics, entertainment, and trending stories from Nairobi and across Kenya. Follow for the latest breaking news and exclusive insights.</p>
          </div>

          <!-- Popular Categories in Footer -->
          <section class="popular-categories" style="margin-top: 2rem; padding: 1.5rem; background: #f8f9fa; border-radius: 8px;">
            <h3 style="margin: 0 0 1rem 0; color: #1a202c;">Popular Kenya News Categories</h3>
            <ul style="list-style: none; padding: 0; display: grid; gap: 0.5rem;">
              {categoryCounts.map(category => (
                <li>
                  <a 
                    href={`/category/${category.name.toLowerCase().replace(/\s+/g, '-')}`} 
                    title={`${category.name} News Kenya`} 
                    style="text-decoration: none; color: #2d3748; font-weight: 600;"
                    class="category-link"
                  >
                    {category.name} ({category.count} articles)
                  </a>
                </li>
              ))}
            </ul>
          </section>
        </div>
      </footer>
    </div>

    <style>
      /* Styles unchanged, included for completeness */
      @media (min-width: 1024px) {
        .post-container {
          max-width: 900px;
          margin: 0 auto;
          padding: 2rem;
        }

        .post-header {
          text-align: center;
          margin-bottom: 3rem;
        }

        .post-title {
          font-size: 2.5rem;
          line-height: 1.2;
          font-weight: 700;
          margin: 1rem 0 1.5rem 0;
          color: #1a1a1a;
        }

        .post-description {
          font-size: 1.25rem;
          color: #4a5568;
          line-height: 1.6;
          max-width: 800px;
          margin: 0 auto 2rem auto;
        }

        .post-featured-image {
          width: 100%;
          height: 500px;
          object-fit: cover;
          border-radius: 12px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .article-wrapper {
          font-size: 1.125rem;
          line-height: 1.8;
          color: #2d3748;
          max-width: none;
        }

        .social-share {
          display: flex;
          gap: 1rem;
          justify-content: center;
          flex-wrap: wrap;
          margin-top: 1.5rem;
        }

        .related-articles {
          background: #f7fafc;
          padding: 2rem;
          border-radius: 12px;
          margin: 3rem 0;
        }

        .related-articles h2 {
          color: #1a202c;
          font-size: 1.75rem;
          margin-bottom: 1.5rem;
          text-align: center;
        }

        .related-articles ul {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          max-width: 800px;
          margin: 0 auto;
        }

        .related-articles li {
          background: white;
          padding: 1rem;
          border-radius: 8px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .mid-content-links {
          margin: 2rem 0;
          padding: 1.5rem;
          background: #f8f9fa;
          border-radius: 8px;
          border: 1px solid #e2e8f0;
        }

        .mid-content-links h3 {
          font-size: 1.25rem;
          color: #1a202c;
          margin-bottom: 1rem;
        }

        .mid-content-links ul {
          display: grid;
          gap: 0.5rem;
        }

        .mid-content-links li {
          background: white;
          padding: 0.75rem;
          border-radius: 6px;
          border: 1px solid #e2e8f0;
        }

        .related-link:hover {
          color: #dc2626;
        }
      }

      .reading-progress {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: rgba(220, 38, 38, 0.2);
        z-index: 100;
      }

      .reading-progress-bar {
        height: 100%;
        background: #dc2626;
        transition: width 0.3s ease;
        width: 0%;
      }

      .author-info {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin: 1.5rem 0;
        padding: 1rem;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #dc2626;
      }

      .author-title {
        color: #666;
        font-size: 0.9rem;
      }

      .reading-time {
        color: #666;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        gap: 0.25rem;
      }

      .ad-container {
        display: flex;
        justify-content: center;
        margin: 2rem 0;
        padding: 1rem;
        background: #fafafa;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
      }

      .back-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 0.75rem;
        border: 1px solid #BB1919;
        border-radius: 4px;
        background: #FFFFFF;
        color: #BB1919;
        font-family: 'ReithSans', 'Helvetica', 'Arial', sans-serif;
        font-size: 0.875rem;
        font-weight: 500;
        text-decoration: none;
        cursor: pointer;
        transition: background 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
        margin: 1rem 0;
      }

      .back-link:hover {
        background: #BB1919;
        color: #FFFFFF;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      }

      .back-link:focus {
        outline: 2px solid #BB1919;
        outline-offset: 2px;
        border-radius: 4px;
      }

      .back-link svg {
        width: 16px;
        height: 16px;
        stroke: currentColor;
      }

      .share-button {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 0.75rem;
        border: 1px solid #E0E0E0;
        border-radius: 4px;
        background: #FFFFFF;
        color: #141414;
        font-family: 'ReithSans', 'Helvetica', 'Arial', sans-serif;
        font-size: 0.875rem;
        font-weight: 500;
        text-decoration: none;
        cursor: pointer;
        transition: background 0.3s ease, box-shadow 0.3s ease;
      }

      .share-button:hover {
        background: #F6F6F6;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      }

      .share-button:focus {
        outline: 2px solid #BB1919;
        outline-offset: 2px;
        border-radius: 4px;
      }

      .share-button svg {
        width: 16px;
        height: 16px;
        fill: currentColor;
      }

      .share-button.x:hover {
        color: #000000;
        border-color: #000000;
      }

      .share-button.linkedin:hover {
        color: #0A66C2;
        border-color: #0A66C2;
      }

      .share-button.facebook:hover {
        color: #1877F2;
        border-color: #1877F2;
      }

      .share-button.whatsapp:hover {
        color: #25D366;
        border-color: #25D366;
      }

      .breadcrumb {
        list-style: none;
        padding: 0.75rem 1rem;
        margin: 0.5rem 0;
        font-size: 0.875rem;
        background: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e2e8f0;
      }

      .breadcrumb li {
        display: inline;
      }

      .breadcrumb li + li:before {
        content: " ‚Ä∫ ";
        padding: 0 0.5rem;
        color: #666;
      }

      .breadcrumb a {
        text-decoration: none;
        color: #BB1919;
        font-weight: 500;
      }

      .breadcrumb a:hover {
        text-decoration: underline;
      }

      .post-meta {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
        justify-content: center;
      }

      .post-category {
        background: #dc2626;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .post-category a {
        color: white;
        text-decoration: none;
      }

      .post-date {
        color: #666;
        font-weight: 500;
        font-size: 0.9rem;
      }

      .draft-notice {
        background: #fef3c7;
        border: 1px solid #f59e0b;
        color: #92400e;
        padding: 1rem;
        border-radius: 8px;
        margin: 1rem 0;
        font-weight: 500;
      }

      .post-footer {
        margin-top: 4rem;
        padding: 2rem 0;
        border-top: 2px solid #e2e8f0;
      }

      .post-footer-content {
        text-align: center;
      }

      .post-footer h3 {
        color: #1a202c;
        margin-bottom: 0.5rem;
        font-size: 1.5rem;
      }

      .post-footer p {
        color: #4a5568;
        margin-bottom: 1.5rem;
      }

      .related-articles {
        margin-top: 3rem;
        padding: 2rem;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 12px;
        border: 1px solid #dee2e6;
      }

      .related-articles h2 {
        font-size: 1.75rem;
        margin-bottom: 1.5rem;
        color: #1a202c;
        text-align: center;
        position: relative;
        padding-bottom: 1rem;
      }

      .related-articles h2::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: #dc2626;
      }

      .related-articles ul {
        list-style: none;
        padding: 0;
        display: grid;
        gap: 1rem;
      }

      .related-articles li {
        background: white;
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }

      .related-articles li:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        border-color: #dc2626;
      }

      .related-articles a {
        text-decoration: none;
        color: #2d3748;
        font-weight: 600;
        display: block;
        transition: color 0.3s ease;
      }

      .related-articles a:hover {
        color: #dc2626;
      }

      .popular-categories {
        margin-top: 2rem;
        padding: 1.5rem;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .popular-categories h3 {
        font-size: 1.25rem;
        color: #1a202c;
        margin-bottom: 1rem;
      }

      .popular-categories ul {
        display: grid;
        gap: 0.5rem;
      }

      .category-link:hover {
        color: #dc2626;
      }

      .category-nav {
        margin: 1rem 0;
      }

      .category-slider {
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
      }

      .category-slider ul {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        scroll-behavior: smooth;
        padding-bottom: 0.5rem;
        scrollbar-width: none;
      }

      .category-slider ul::-webkit-scrollbar {
        display: none;
      }

      .category-slider li {
        flex: 0 0 auto;
      }

      .category-slider a {
        display: inline-block;
        white-space: nowrap;
        padding: 0.5rem 1rem;
        background: #dc2626;
        color: white;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        text-decoration: none;
        transition: background 0.3s ease;
      }

      .category-slider a:hover {
        background: #b91c1c;
      }

      @media (min-width: 769px) {
        .category-slider ul {
          flex-wrap: wrap;
          overflow-x: visible;
          padding-bottom: 0;
        }

        .category-slider li {
          flex: none;
        }
      }

      @media (max-width: 768px) {
        .post-container {
          padding: 1rem;
        }

        .post-title {
          font-size: 1.75rem;
        }

        .post-description {
          font-size: 1rem;
        }

        .post-meta {
          justify-content: flex-start;
          gap: 0.75rem;
        }

        .social-share {
          justify-content: center;
        }

        .newsletter-signup {
          padding: 1.5rem 1rem;
        }

        .newsletter-signup div {
          flex-direction: column;
          gap: 1rem;
        }

        .author-info {
          flex-direction: column;
          align-items: flex-start;
          gap: 0.5rem;
        }

        .related-articles ul {
          grid-template-columns: 1fr;
        }

        .mid-content-links ul {
          grid-template-columns: 1fr;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .back-link,
        .share-button,
        .related-articles li,
        .category-link,
        .related-link,
        .category-slider a {
          transition: none;
        }
      }

      @media print {
        .reading-progress,
        .back-link,
        .social-share,
        .ad-container,
        .newsletter-signup,
        .category-nav,
        .mid-content-links,
        .popular-categories {
          display: none !important;
        }
        
        .post-container {
          max-width: none;
          padding: 0;
        }
      }

      .breadcrumb a:focus,
      .back-link:focus,
      .share-button:focus,
      .related-articles a:focus,
      .category-nav a:focus,
      .related-link:focus,
      .category-link:focus {
        outline: 2px solid #dc2626;
        outline-offset: 2px;
        border-radius: 4px;
      }
    </style>

    <script>
      function updateReadingProgress() {
        const article = document.querySelector('article');
        const progressBar = document.getElementById('progress-bar');
        
        if (!article || !progressBar) return;
        
        const articleTop = article.offsetTop;
        const articleHeight = article.offsetHeight;
        const windowHeight = window.innerHeight;
        const scrollTop = window.scrollY;
        
        const articleStart = articleTop - windowHeight;
        const articleEnd = articleTop + articleHeight;
        
        if (scrollTop < articleStart) {
          progressBar.style.width = '0%';
        } else if (scrollTop > articleEnd) {
          progressBar.style.width = '100%';
        } else {
          const progress = (scrollTop - articleStart) / (articleEnd - articleStart);
          progressBar.style.width = Math.min(100, Math.max(0, progress * 100)) + '%';
        }
      }
      
      function handleNewsletterSignup() {
        const button = document.querySelector('.newsletter-signup button');
        const input = document.querySelector('.newsletter-signup input');
        
        if (button && input) {
          button.addEventListener('click', function(e) {
            e.preventDefault();
            const email = input.value.trim();
            if (email && email.includes('@')) {
              button.textContent = 'Subscribed!';
              button.style.background = '#10b981';
              input.value = '';
              setTimeout(() => {
                button.textContent = 'Subscribe';
                button.style.background = 'white';
              }, 3000);
            } else {
              button.textContent = 'Invalid Email';
              button.style.background = '#ef4444';
              setTimeout(() => {
                button.textContent = 'Subscribe';
                button.style.background = 'white';
              }, 2000);
            }
          });
        }
      }
      
      console.log('Category:', '%%category%%');
      console.log('Title:', '%%title%%');
      
      window.addEventListener('scroll', updateReadingProgress);
      window.addEventListener('resize', updateReadingProgress);
      window.addEventListener('load', () => {
        updateReadingProgress();
        handleNewsletterSignup();
      });
    </script>
</Layout>