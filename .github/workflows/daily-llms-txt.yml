name: Daily llms.txt + Sitemap
on:
  schedule:
    - cron: '0 2 * * *'  # 5AM EAT
  workflow_dispatch:
jobs:
  generate:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - uses: actions/checkout@v4
    - name: Generate Files
      run: |
        mkdir -p public
        npx llmstxt@latest gen https://www.jonathanmwaniki.co.ke/sitemap-0.xml --exclude-path "**/privacy**" --exclude-path "**/terms**" > llms.txt
        cp llms.txt public/llms.txt
        curl -s -o public/sitemap.xml https://www.jonathanmwaniki.co.ke/sitemap-0.xml || echo "Sitemap fetch skipped"
    - name: Commit Both Locations
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: Daily llms.txt + sitemap (root + public)
        file_pattern: |
          llms.txt
          public/llms.txt
          public/sitemap.xml